<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rubik+Broken+Fax&family=Space+Grotesk:wght@300..700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="stylesheet" href="../static/css/style.css" />
    <link rel="icon" type="image/png" href="../favicon.png" />
    <title>Caterpillar Quest - Jack Drabenstadt</title>
  </head>
  <body>
    <nav id="navbar">
      <div class="navbar-top">
        <span class="navbar-name">
          <span class="name-full">Jack Drabenstadt</span>
          <span class="name-short">JD</span>
        </span>
        <span class="navbar-page">Game Dev</span>
        <div class="navbar-socials">
          <div class="resume-dropdown">
            <span class="navbar-resume">Resume</span>
            <div class="resume-dropdown-menu">
              <a href="../static/resumes/software_dev_resume.pdf" target="_blank"
                >Software Dev</a
              >
              <a href="../static/resumes/game_dev_resume.pdf" target="_blank"
                >Game Design</a
              >
            </div>
          </div>
          <a
            href="/gamedev/pages/gamelog.html"
            target="_blank"
            class="navbar-resume"
            >Dev Log</a
          >
          <a
            href="https://www.linkedin.com/in/jackdrabenstadt/"
            target="_blank"
            aria-label="LinkedIn"
            ><i class="fa-brands fa-linkedin"></i
          ></a>
          <a
            href="https://github.com/drabenstadtj"
            target="_blank"
            aria-label="GitHub"
            ><i class="fa-brands fa-github"></i
          ></a>
          <a
            href="https://drabenstadtj.itch.io/"
            target="_blank"
            aria-label="Itch.io"
            ><i class="fa-brands fa-itch-io"></i
          ></a>
        </div>
      </div>
      <div class="navbar-links">
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="../projects.html">Projects</a></li>
          <li><a href="../gamedev.html" class="active">Game Dev</a></li>
          <li><a href="../writing.html">Writing</a></li>
        </ul>
      </div>
    </nav>

    <div id="navbar-spacer"></div>
    <main class="content-strip">
      <h1>Caterpillar Quest</h1>

      <div class="project-meta">
        <a href="#play-it" class="tag tag-live"
          ><i class="fa-solid fa-gamepad"></i> Playable</a
        >
        <span class="project-meta-divider"></span>
        <span class="tag">Unity</span>
        <span class="tag">C#</span>
        <span class="tag">Arduino</span>
        <span class="tag">Python</span>
        <span class="tag">Blender</span>
      </div>

      <p>
        A casual exploration game inspired by <em>The Very Hungry Caterpillar</em>,
        paired with a custom Arduino glove controller built from scratch.
      </p>

      <div class="game-wrapper" id="play-it">
        <div class="game-placeholder" id="game-placeholder">
          <img src="../static/images/caterpillar_thumbnail.png" alt="Caterpillar Quest" />
          <button class="game-play-btn" onclick="startGame()" aria-label="Play game">
            <i class="fa-solid fa-play"></i>
          </button>
        </div>
        <iframe
          id="game-frame"
          data-src="../static/games/caterpillar-quest/index.html"
          width="100%"
          frameborder="0"
          scrolling="no"
          allowfullscreen
          style="display: none; border-radius: 10px; aspect-ratio: 960/600; height: auto;"
        ></iframe>
        <button class="game-fullscreen-btn" id="fullscreen-btn" onclick="toggleFullscreen()" title="Fullscreen" style="display: none;">
          <i class="fa-solid fa-expand"></i>
        </button>
      </div>
      <script>
        function startGame() {
          document.getElementById('game-placeholder').remove();
          var iframe = document.getElementById('game-frame');
          iframe.src = iframe.dataset.src;
          iframe.style.display = 'block';
          document.getElementById('fullscreen-btn').style.display = 'block';
        }
        function toggleFullscreen() {
          var wrapper = document.getElementById('play-it');
          if (document.fullscreenElement) {
            document.exitFullscreen();
          } else if (wrapper.requestFullscreen) {
            wrapper.requestFullscreen().catch(function () {
              wrapper.classList.toggle('game-fullscreen-mobile');
              updateFsIcon(wrapper.classList.contains('game-fullscreen-mobile'));
            });
          } else {
            wrapper.classList.toggle('game-fullscreen-mobile');
            updateFsIcon(wrapper.classList.contains('game-fullscreen-mobile'));
          }
        }
        function updateFsIcon(isFs) {
          document.getElementById('fullscreen-btn').querySelector('i').className =
            isFs ? 'fa-solid fa-compress' : 'fa-solid fa-expand';
        }
        document.addEventListener('fullscreenchange', function () {
          updateFsIcon(!!document.fullscreenElement);
        });
      </script>

      <h3>The Game</h3>
      <p>
        Players move the caterpillar toward the cursor and jump with right click.
        Eating food increases size, unlocking larger foods and new areas — but
        growing too large locks you out of smaller spaces you previously explored.
        Three levels progress from morning to evening to night, each with unique
        lighting and environmental challenges.
      </p>
      <p>
        Food choices have strategic tradeoffs: blueberries grant a jump,
        strawberries give a speed boost. NPC interactions with a slug early on
        and a cat late game offer optional dialogue and perspective on the
        caterpillar's metamorphosis. Size is simultaneously progression and
        constraint — the central design tension.
      </p>

      <figure>
        <img
          src="../static/images/caterpillar.gif"
          alt="Caterpillar Quest gameplay"
          class="img-strip"
        />
      </figure>

      <h3>Custom Hardware Controller</h3>
      <p>
        I built a custom Arduino glove controller to pair with the game. An
        MPU6050 accelerometer tracks hand tilt and maps it directly to cursor
        position — level hand centers the cursor, tilting moves it
        proportionally. Penny buttons sewn into the glove fingers complete
        circuits when touched to a thumb ground, emulating left and right mouse
        clicks.
      </p>
      <p>
        The first control scheme was velocity-based: the Arduino calculated
        movement vectors and PyAutoGUI moved the mouse relative to its current
        position. This produced choppy, drifting movement. Switching to pynput
        fixed choppiness but not the underlying problem — accelerometers measure
        force, not position, so velocity control was fundamentally mismatched to
        the hardware.
      </p>
      <p>
        The fix was joystick-style absolute positioning. Cursor position is now
        mapped directly to tilt angle relative to a calibrated neutral. Hold
        level, cursor stays centered; tilt left, cursor moves left. Immediately
        more intuitive. The Python pipeline handles auto-detection, calibration,
        deadzone filtering, and scaling.
      </p>
      <p>
        The hardware iterated too. Planned 3D-printed finger buttons with tactile
        switches were abandoned after impatient supergluing rendered both
        prototypes non-functional. We switched to pennies: drilled, soldered, and
        sewn into the glove. Not elegant, but it worked reliably through the
        entire playtest.
      </p>

      <figure>
        <img
          src="../static/images/controller_glove_final.jpeg"
          alt="Finished Arduino glove controller"
          class="img-strip"
        />
      </figure>

      <h3>Playtesting</h3>
      <p>
        A blind playtest with five users surfaced the key issues: food was hard
        to spot against the environment, dialogue boxes blocked the view, and
        players wanted zoom control. We added food contrast, a progress bar,
        scroll-wheel zoom, and movement lock during dialogue. Players
        consistently cited movement and jumping as the most enjoyable parts.
      </p>

    </main>
    <script src="../static/js/navbar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <script src="../static/js/sketch.js"></script>
  </body>
</html>
